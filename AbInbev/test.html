<head>
  <title>App</title>
  <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100%; }
    </style>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false">
    </script>
    <script src="http://d3js.org/d3.v3.js" charset="utf-8"></script>
    <script src="Polyline_context.js"></script>

    <script src="proj4.js"></script>

    <script type="text/javascript">
    var map;
    var polyline;
      function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(53.567, 9.944),
          zoom: 2,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map-canvas"),
            mapOptions);
        polyline = new google.maps.Polygon({
          map: map
        });

        d3init();
      }
      var context;
      var width;
      var height;
      var path;
      var graticule;
      var equator;
      var projection;

      function d3init() {
        width = map.getDiv().offsetWidth;
        height = map.getDiv().offsetHeight;

        //
        //equator = {type: 'LineString', coordinates: [[-180, 20], [-90, 0], [0, -20], [90, 0], [180, 20]]};
        d3.json("data1.json", function(dat) {

            projection = d3.geo.albers();
            projection
              .scale(30)
              .translate([-58,-34])
              .rotate([-30,50,20]) // lateral / vertical / longitudinal
              .center([-34,-58]);

            context = new PolylineContext();
            path = d3.geo.path()
                .projection(projection)
                .context(context);

            equator = dat;
            render();
        });
      }

      function render() {
        polyline.setOptions({
          strokeColor: 'red',
          strokeWeight: 1
        });
        context.setCurrent(polyline.getPath()); //context.currentPath = polyline.getPath();

        path(equator);
      }

      google.maps.event.addDomListener(window, 'load', initialize);


    </script>
</head>

<body>

    <div id="map-canvas">
    </div>
</body>